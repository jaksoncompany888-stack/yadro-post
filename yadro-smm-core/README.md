# Yadro — SMM Agent

AI-агент для ведения Telegram-каналов. Генерирует посты, анализирует конкурентов, редактирует контент голосом или текстом.

## Что умеет

### Генерация контента
- **Посты по теме** — напиши тему, получи готовый пост в твоём стиле
- **Посты с исследованием** — агент ищет актуальную информацию в интернете
- **Учёт стиля конкурентов** — анализирует каналы и адаптирует тон
- **Голосовой ввод** — отправь голосовое, агент поймёт

### Редактирование (гибридный режим v7)
- **Точечные правки кодом** — "убери хештеги", "удали последний абзац", "выдели жирным"
- **Творческие правки через LLM** — "добавь хук", "сделай живее", "сократи"
- **Комбинированные** — "убери эмодзи и добавь цепляющее начало"

### Анализ
- **Конкуренты** — добавь каналы, агент проанализирует их стиль
- **Метрики без LLM** — средняя длина, эмодзи/пост, хештеги, форматирование
- **Глубокий анализ** — темы, tone of voice, структура постов

### Память
- **Стиль канала** — запоминает и использует при генерации
- **Успешные посты** — учится на том, что зашло
- **Фидбек** — "слишком длинно" → запомнит на будущее
- **FTS5 поиск** — находит релевантный контекст по теме

### Планирование
- **Черновики** — сохраняй и публикуй позже
- **Отложенные посты** — запланируй на конкретное время
- **Идеи на день** — предложения тем на основе трендов

## Чего пока не делает

- **Автопостинг** — публикация только вручную (безопасность)
- **Мониторинг метрик** — нет автосбора просмотров/реакций
- **Картинки** — только текст, без генерации изображений
- **Кросспостинг** — один канал на пользователя
- **Twitter/X мониторинг** — пока нет

## Архитектура

```
Telegram Bot (aiogram)
    ↓
SMMAgent — координатор
    ↓
┌─────────────────────────────────────────┐
│ Executor → Plan → Steps                 │
│   ├── TOOL_CALL (memory, web, parse)    │
│   ├── LLM_CALL (генерация, анализ)      │
│   └── APPROVAL (пауза на одобрение)     │
└─────────────────────────────────────────┘
    ↓
Memory (FTS5) + Tools (browser, parser)
    ↓
SQLite (WAL mode)
```

**Принцип:** Архитектура > Промпты. Логика в коде (Plan/Steps), LLM только исполняет.

## Быстрый старт

### 1. Клонируй репозиторий
```bash
git clone https://github.com/jaksoncompany888-stack/Yadro.git
cd Yadro
```

### 2. Создай виртуальное окружение
```bash
python -m venv venv
source venv/bin/activate  # macOS/Linux
```

### 3. Установи зависимости
```bash
pip install -r requirements.txt
playwright install chromium
```

### 4. Настрой окружение
```bash
cp .env.example .env
```

Заполни `.env`:
```
TELEGRAM_BOT_TOKEN=...
OPENAI_API_KEY=...
```

### 5. Запусти бота
```bash
python run_all.py  # бот + API вместе
```

## Команды бота

| Команда | Описание |
|---------|----------|
| `/start` | Онбординг (канал → конкуренты → стиль) |
| `/post` | Создать пост |
| `/ideas` | Идеи для постов |
| `/drafts` | Черновики |
| `/competitor` | Добавить конкурента |
| `/competitors` | Список конкурентов |
| `/analyze` | Анализ конкурентов |
| `/research` | Пост с исследованием темы |
| `/news` | Горячие темы из RSS |
| `/source` | Добавить источник новостей |
| `/style` | Изменить стиль |
| `/report` | Недельный отчёт |

## Структура проекта

```
app/
├── smm/           # SMM Agent + Telegram бот
│   ├── agent.py   # Главный класс (~850 строк)
│   ├── bot.py     # Telegram handlers (~1100 строк)
│   └── scheduler_tasks.py  # Фоновые задачи
├── executor/      # Plan/Steps архитектура
├── kernel/        # Task State Machine
├── llm/           # OpenAI интеграция
├── memory/        # FTS5 память
├── tools/         # Парсинг каналов, веб-поиск
└── storage/       # SQLite база
```

## Тестирование

```bash
# Все тесты (300+ штук)
pytest tests/ -v
```

## Планы развития

### Ближайшее
- [ ] A/B тестирование постов (2-3 варианта)
- [ ] Автосбор метрик (просмотры, реакции)
- [ ] Контент-календарь на неделю

### В будущем
- [ ] Генерация картинок
- [ ] Twitter/X мониторинг
- [ ] Кросспостинг в несколько каналов
- [ ] Цепочки связанных постов

## Документация

Подробная техническая документация в [CLAUDE.md](CLAUDE.md)

## Лицензия

Проприетарный код. Все права защищены.
